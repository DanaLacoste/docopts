#!/usr/bin/env python
# -*- coding: utf-8 -*-
# vim: set ts=4 sw=4 sts=4 et:

import os
import sys
import tempfile

from docopt import docopt

# parse arguments or abort if there is an error in docopt
try:
    args = docopt(doc           = sys.stdin.read(),
                  argv          = sys.argv[1:],
                  help          = False,
                  version       = None,
                  options_first = 'POSIXLY_CORRECT' in os.environ)
except Exception as e:
    sys.exit("%s: %s" % (sys.argv[0], e))

# store the arguments in a directory and print its path
tempdir = tempfile.mkdtemp(prefix="docopts-")
for arg, value in args.items():
    path = os.path.join(tempdir, arg)
    if isinstance(value, list):
        os.mkdir(path, 448) # user only read, write, execute
        for i,v in enumerate(value):
            with open(os.path.join(path, str(i+1)), 'w') as f:
                f.write(v)
    elif isinstance(value, str):
        with open(path, 'w') as f: f.write(value)
    elif isinstance(value, bool):
        if value: open(path, 'w').close()
    elif isinstance(value, int):
        with open(path, 'w') as f: f.write(str(value))

print(tempdir)
